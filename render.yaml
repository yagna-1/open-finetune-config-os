services:
  - type: web
    name: ft-config-engine-api
    env: docker
    dockerfilePath: ./Dockerfile
    autoDeploy: true
    plan: starter
    envVars:
      - key: FT_CONFIG_DATASET_PATH
        value: /app/finetuning_configs_final.jsonl
      - key: DATABASE_URL
        fromDatabase:
          name: ft-config-engine-db
          property: connectionString
      - key: CORS_ORIGINS
        value: https://ft-config-engine-ui.onrender.com
      - key: TRUSTED_HOSTS
        value: ft-config-engine-api.onrender.com
      - key: REQUIRE_API_KEY
        value: "true"
      - key: API_KEY
        sync: false
      - key: EXPOSE_INTERNALS
        value: "false"
      - key: RATE_LIMIT_PER_MINUTE
        value: "60"

  - type: web
    name: ft-config-engine-ui
    env: docker
    dockerfilePath: ./Dockerfile
    rootDir: frontend
    autoDeploy: true
    plan: starter
    envVars:
      - key: API_BASE_URL_SERVER
        value: https://ft-config-engine-api.onrender.com
      - key: NEXT_PUBLIC_API_BASE_URL
        value: https://ft-config-engine-api.onrender.com
      - key: API_KEY_SERVER
        sync: false
      - key: NEXT_PUBLIC_API_KEY
        sync: false

databases:
  - name: ft-config-engine-db
    databaseName: ft_config_engine
    user: ft_user
    plan: starter
